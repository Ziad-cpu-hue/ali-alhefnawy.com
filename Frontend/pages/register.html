{% load static %}

<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <!-- Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± Ø¶Ø±ÙˆØ±ÙŠ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø´Ø§Ø´Ø§Øª -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
      }
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      .reg-root {
        font-family: "Poppins", sans-serif;
        background: #060097;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }
      .reg-wrapper {
        width: 95%;
        max-width: 1200px;
        text-align: center;
        color: #fff;
        margin: 0 auto;
      }
      .reg-header {
        margin-bottom: 30px;
      }
      .reg-header h1 {
        font-size: 3rem;
        letter-spacing: 1px;
        text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);
        margin-bottom: 10px;
      }
      .reg-header p {
        font-size: 1.2rem;
        margin-bottom: 5px;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
      }
      .reg-promo {
        margin: 20px 0;
        font-size: 1rem;
        font-weight: 500;
        color: #eefafd;
      }
      .reg-promo a {
        color: #ddebf1;
        text-decoration: underline;
        font-weight: 600;
      }
      .reg-form-box {
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 30px 40px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        margin-bottom: 30px;
      }
      .reg-form-box h2 {
        margin-bottom: 20px;
        font-size: 2rem;
        color: #e8f0f1;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
      }
      .reg-row {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        gap: 20px;
      }
      .reg-group {
        width: calc(50% - 20px);
        position: relative;
      }
      .reg-group.full {
        width: 100%;
        margin-top: 20px;
      }
      .reg-group label {
        display: block;
        margin-bottom: 6px;
        font-size: 1rem;
        font-weight: 600;
        color: #dcebf1;
      }
      .reg-group input,
      .reg-group select {
        width: 100%;
        padding: 14px 20px;
        background: #fff;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 1rem;
        outline: none;
        transition: all 0.3s ease;
      }
      .reg-group input::placeholder,
      .reg-group select::placeholder {
        color: #aaa;
      }
      .reg-group input:hover,
      .reg-group select:hover {
        border-color: #66a6ff;
      }
      .reg-group input:focus,
      .reg-group select:focus {
        border-color: #66a6ff;
        box-shadow: 0 2px 8px rgba(102, 166, 255, 0.4);
      }
      /* file input styling */
      .reg-group input[type="file"] {
        padding: 10px 12px;
      }
      .reg-error {
        color: #ff8080;
        font-size: 0.85rem;
        margin-top: 5px;
        display: none;
        text-align: right;
      }
      .reg-btn-submit {
        background: linear-gradient(135deg, #2b2ee9, #230375);
        color: #f7fbfc;
        border: none;
        padding: 15px;
        width: 20%;
        min-width: 150px;
        font-size: 1.1rem;
        border-radius: 30px;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        margin-top: 25px;
        font-weight: 700;
        align-self: flex-end;
      }
      .reg-btn-submit:hover {
        transform: scale(1.03);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
      }

      /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
      .reg-modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.4s ease;
        z-index: 1000;
      }
      .reg-modal-overlay.active {
        opacity: 1;
        pointer-events: all;
      }
      .reg-modal-content {
        background: linear-gradient(135deg, #ffffff, #f0f4ff);
        color: #060097;
        padding: 30px 40px;
        border-radius: 20px;
        text-align: center;
        transform: translateY(-40px) scale(0.9);
        opacity: 0;
        transition: transform 0.4s ease, opacity 0.4s ease;
        max-width: 90%;
        width: 380px;
        box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
        position: relative;
      }
      .reg-modal-overlay.active .reg-modal-content {
        transform: translateY(0) scale(1);
        opacity: 1;
      }
      .reg-modal-content::before {
        content: "";
        position: absolute;
        top: -10px;
        left: -10px;
        right: -10px;
        bottom: -10px;
        background: linear-gradient(45deg, #032295, #2c0492);
        z-index: -1;
        border-radius: 25px;
        filter: blur(14px);
        opacity: 0.6;
      }
      .reg-modal-content .reg-icon {
        font-size: 4rem;
        margin-bottom: 15px;
      }
      .reg-modal-content h3 {
        margin-bottom: 15px;
        font-size: 2.2rem;
        font-weight: 700;
      }
      .reg-modal-content p {
        margin-bottom: 25px;
        font-size: 1.1rem;
        line-height: 1.4;
      }
      .reg-modal-content button {
        background: linear-gradient(135deg, #2b2ee9, #230375);
        color: #f7fbfc;
        border: none;
        padding: 12px 30px;
        font-size: 1rem;
        border-radius: 25px;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .reg-modal-content button:hover {
        transform: scale(1.05);
        box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
      }

      /* responsive */
      @media (max-width: 1024px) {
        .reg-header h1 {
          font-size: 2.5rem;
        }
        .reg-header p {
          font-size: 1.1rem;
        }
        .reg-form-box {
          padding: 25px 30px;
        }
        .reg-form-box h2 {
          font-size: 1.8rem;
        }
        .reg-row {
          gap: 15px;
        }
        .reg-group {
          width: calc(50% - 15px);
        }
        .reg-btn-submit {
          width: 30%;
        }
      }
      @media (max-width: 768px) {
        .reg-row {
          flex-direction: column;
          gap: 10px;
        }
        .reg-group {
          width: 100%;
        }
        .reg-btn-submit {
          width: 100%;
          margin-top: 15px;
        }
        .reg-form-box {
          padding: 20px;
        }
        .reg-form-box h2 {
          font-size: 1.6rem;
        }
        .reg-header h1 {
          font-size: 2rem;
        }
        .reg-header p {
          font-size: 1rem;
        }
        .reg-modal-content {
          width: 90%;
          padding: 25px 30px;
        }
        .reg-modal-content h3 {
          font-size: 1.9rem;
        }
        .reg-modal-content p {
          font-size: 1rem;
        }
      }
      @media (max-width: 480px) {
        .reg-form-box {
          padding: 15px;
        }
        .reg-form-box h2 {
          font-size: 1.4rem;
        }
        .reg-header h1 {
          font-size: 1.6rem;
        }
        .reg-header p {
          font-size: 0.9rem;
        }
        .reg-group input,
        .reg-group select {
          padding: 12px 15px;
          font-size: 0.95rem;
        }
        .reg-btn-submit {
          padding: 12px;
          font-size: 1rem;
        }
        .reg-modal-content {
          width: 95%;
          padding: 20px 25px;
        }
        .reg-modal-content h3 {
          font-size: 1.6rem;
        }
        .reg-modal-content p {
          font-size: 0.95rem;
        }
      }

      /* Ø®Ø§Øµ: Ù‚Ø§Ø¹Ø¯Ø© Ù„Ø¥Ø®ÙØ§Ø¡ Ø®Ø§Ù†Ø© Ø§Ù„ØµÙˆØ±Ø© (ÙŠÙ…ÙƒÙ† ØªØ·Ø¨ÙŠÙ‚Ù‡Ø§ Ø¹Ø¨Ø± JS Ø¯ÙˆÙ† Ø­Ø°Ù HTML) */
      .__hide-avatar__ {
        display: none !important;
      }
      /*************************************/
      /* ØªØ­Ø¯ÙŠØ« ØªØµÙ…ÙŠÙ… Ø²Ø± "ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù…" â€” Ø£Ù„ÙˆØ§Ù† Ù…Ø±ÙŠØ­Ø© ÙˆØ¬Ø°Ø§Ø¨Ø© + ØµÙˆØ±Ø© Ø¨Ø¯Ù„ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
      /* Ø§Ø³ØªÙ‡Ø¯Ø§Ù Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ø§Ù„Ù€ attribute selector (Ù„Ù† Ù†ØºÙŠÙ‘Ø± Ø£ÙŠ HTML) */
      a[href^="https://wa.me/201556060683"]
      {
        display: inline-flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 12px !important;
        padding: 12px 20px !important;
        min-width: 170px !important;
        width: auto !important;
        font-size: 1.03rem !important;
        font-weight: 800 !important;
        color: #04202a !important; /* Ù†Øµ Ø¯Ø§ÙƒÙ† Ø¹Ù„Ù‰ Ø®Ù„ÙÙŠØ© ÙØ§ØªØ­Ø© */
        text-decoration: none !important;
        border-radius: 14px !important;
        border: none !important;
        background: linear-gradient(
          135deg,
          #e6fffa 0%,
          #dff8f2 38%,
          #c6f0e9 100%
        ) !important; /* Ù…Ø±ÙŠØ­ Ù„Ù„Ø¹ÙŠÙ† */
        box-shadow: 0 6px 20px rgba(2, 18, 23, 0.08),
          0 2px 6px rgba(6, 150, 136, 0.06);
        transition: transform 200ms cubic-bezier(0.2, 0.9, 0.2, 1),
          box-shadow 200ms, background 350ms !important;
        position: relative !important;
        overflow: hidden !important;
        padding-right: 22px !important;
        padding-left: 22px !important;
        text-align: center !important;
      }

      /* Ø£Ù†Ø´Ø¦ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù„Ù„ØµÙˆØ±Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± (Ø¨Ø¯Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ) */
      a[href^="https://wa.me/201556060683"]::before
      {
        content: "";
        display: inline-block;
        width: 40px;
        height: 40px;
        border-radius: 10px;
        background-repeat: no-repeat;
        background-position: center;
        background-size: contain;
        margin-inline-end: 8px;
        box-shadow: 0 4px 12px rgba(2, 18, 23, 0.06) inset;
        /* Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø©: ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¹Ø¨Ø± JS Ø£Ùˆ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø³Ø§Ø± Ù…Ø¨Ø§Ø´Ø±Ø© */
        background-image: url("{% static 'images/â€”Pngtreeâ€”whatsapp icon_8704827.png' %}");
      }

      /* Ù†Øµ Ø§Ù„Ø²Ø±: Ù„ÙˆÙ† Ù…ØªØ¨Ø§ÙŠÙ† Ù„Ø·ÙŠÙ */
      a[href^="https://wa.me/201556060683"] span,
a[href^="https://wa.me/201556060683"] > *
      {
        color: #04202a !important;
      }

      /* Hover effect */
      a[href^="https://wa.me/201556060683"]:hover
      {
        transform: translateY(-4px) !important;
        box-shadow: 0 18px 50px rgba(2, 18, 23, 0.14),
          0 6px 22px rgba(6, 150, 136, 0.08);
        background: linear-gradient(
          135deg,
          #f0fffd 0%,
          #e6fff8 50%,
          #dff8f2 100%
        ) !important;
      }

      /* Focus (accessibility) */
      a[href^="https://wa.me/201556060683"]:focus
      {
        outline: 3px solid rgba(34, 193, 166, 0.18) !important;
        outline-offset: 4px !important;
      }

      /* Responsive tweak */
      @media (max-width: 720px) {
        a[href^="https://wa.me/201556060683"]
        {
          padding: 10px 14px !important;
          min-width: 140px !important;
          font-size: 1rem !important;
        }
        a[href^="https://wa.me/201556060683"]::before
        {
          width: 34px;
          height: 34px;
          margin-inline-end: 6px;
        }
      }
    </style>
  </head>
  <body>
    <div class="reg-root">
      <div class="reg-wrapper">
        <div class="reg-header">
          <h1>Ø§Ù†Ø¶Ù… Ù„Ø¹Ø§Ù„Ù…Ù†Ø§</h1>
          <p>ØªØ¬Ø±Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø±Ùƒ! Ø§ÙƒØªØ´Ù Ø§Ù„Ø¢Ù†!</p>
          <p class="reg-promo">
            Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ <a href="#">Ø§Ø¯Ø®Ù„ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ Ø§Ù„Ø¢Ù†!</a>
          </p>
        </div>
        <div class="reg-form-box">
          <h2>Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨</h2>
          <a
            href="https://wa.me/201556060683?text=Ù…Ø±Ø­Ø¨Ø§ØŒ Ù„Ø¯ÙŠ Ù…Ø´ÙƒÙ„Ø© ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨"
            style="
              background: linear-gradient(135deg, #25d366, #128c7e);
              color: #fff;
              background-image: url(images/WhatsApp\ Image\ 2025-07-12\ at\ 7.19.47\ PM.jpeg);
              border: none;
              padding: 15px;
              width: 20%;
              min-width: 150px;
              font-size: 1.1rem;
              border-radius: 30px;
              cursor: pointer;
              transition: transform 0.3s ease, box-shadow 0.3s ease;
              margin-top: 25px;
              font-weight: 700;
              text-decoration: none;
              display: inline-block;
              text-align: center;
            "
            >ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù…
          </a>
          <form
            id="regForm"
            action="{% url 'accounts:register_student' %}"
            method="POST"
            enctype="multipart/form-data"
          >
            {% csrf_token %}
            <div class="reg-row">
              <div class="reg-group">
                <label for="regFirstName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„</label>
                <input
                  type="text"
                  id="regFirstName"
                  name="first_name"
                  placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„"
                  required
                />
                <div class="reg-error" id="regFirstNameError">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£ÙˆÙ„.
                </div>
              </div>
              <div class="reg-group">
                <label for="regLastName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±</label>
                <input
                  type="text"
                  id="regLastName"
                  name="last_name"
                  placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±"
                  required
                />
                <div class="reg-error" id="regLastNameError">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø£Ø®ÙŠØ±.
                </div>
              </div>
              <div class="reg-group">
                <label for="regPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                <input
                  type="tel"
                  id="regPhone"
                  name="phone_number"
                  placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"
                  required
                />
                <div class="reg-error" id="regPhoneError">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­.
                </div>
              </div>
              <div class="reg-group">
                <label for="regParentPhone">Ø±Ù‚Ù… Ù‡Ø§ØªÙ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</label>
                <input
                  type="tel"
                  id="regParentPhone"
                  name="parent_phone_number"
                  placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±"
                  required
                />
                <div class="reg-error" id="regParentPhoneError">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ÙˆÙ„ÙŠ Ø£Ù…Ø± ØµØ­ÙŠØ­.
                </div>
              </div>
              <div class="reg-group">
                <label for="regGovernorate">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label>
                <input
                  type="text"
                  id="regGovernorate"
                  name="governorate"
                  placeholder="Ø§Ø®ØªØ± Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©"
                  list="regGovernorateList"
                  required
                />
                <datalist id="regGovernorateList">
                  <option value="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©"></option>
                  <option value="Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©"></option>
                  <option value="Ø§Ù„Ø¬ÙŠØ²Ø©"></option>
                </datalist>
                <div class="reg-error" id="regGovernorateError">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©.
                </div>
              </div>
              <div class="reg-group">
                <label for="regGrade">Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                <select id="regGrade" name="grade" required>
                  <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>

                  <!-- Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠØ© -->
                  <option value="4">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
                  <option value="5">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>
                  <option value="6">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ÙŠ</option>

                  <!-- Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© -->
                  <option value="1">Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                  <option value="2">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                  <option value="3">Ø§Ù„ØµÙ Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                </select>
                <div class="reg-error" id="regGradeError">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ.
                </div>
              </div>

              <div class="reg-group">
                <label for="regPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input
                  type="password"
                  id="regPassword"
                  name="password"
                  placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
                  required
                />
                <div class="reg-error" id="regPasswordError">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„).
                </div>
              </div>
              <div class="reg-group">
                <label for="regConfirmPassword">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                <input
                  type="password"
                  id="regConfirmPassword"
                  name="confirm_password"
                  placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
                  required
                />
                <div class="reg-error" id="regConfirmPasswordError">
                  ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©.
                </div>
              </div>

              <!-- NEW: Ø­Ù‚Ù„ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠ (Ø¢Ø®Ø± Ø®Ø§Ù†Ø© Ù‚Ø¨Ù„ Ø²Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„) -->
              <div class="reg-group full" id="regAvatarWrapper">
                <label for="regAvatar">Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© (Ø§Ø¬Ø¨Ø§Ø±ÙŠ)</label>
                <input
                  type="file"
                  id="regAvatar"
                  name="avatar"
                  accept="image/*"
                  required
                />
                <div class="reg-error" id="regAvatarError">
                  Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ ØµÙˆØ±Ø© Ø´Ø®ØµÙŠØ© (JPEG, PNG) Ø¨Ø­Ø¬Ù… Ø£Ù‚ØµÙ‰ 2 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª.
                </div>
              </div>
            </div>

            <div class="reg-group full">
              <!-- ØºÙŠØ±Ù†Ø§ type Ø¥Ù„Ù‰ button ÙˆØ£Ø¶ÙÙ†Ø§ id -->
              <button type="button" id="regSubmitBtn" class="reg-btn-submit">
                Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¬Ø§Ù‡Ø²Ø© Ù…Ù† Ù‚Ø¨Ù„ÙƒÙ… -->
      <div id="regSuccessModal" class="reg-modal-overlay">
        <div class="reg-modal-content">
          <div class="reg-icon">ğŸ‰</div>
          <h3 id="modalTitle">ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!</h3>
          <p id="modalMessage">âœ¨ Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¹Ø§Ø¦Ù„ØªÙ†Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ğŸ˜Š</p>
          <button id="modalConfirmBtn">Ø­Ø³Ù†Ø§Ù‹</button>
        </div>
      </div>
    </div>

    <script>
      function showModal({ icon, title, message, redirect }) {
        const overlay = document.getElementById("regSuccessModal");
        overlay.querySelector(".reg-icon").textContent = icon;
        overlay.querySelector("#modalTitle").textContent = title;
        overlay.querySelector("#modalMessage").textContent = message;
        const btn = document.getElementById("modalConfirmBtn");
        btn.onclick = () => {
          overlay.classList.remove("active");
          if (redirect) {
            window.location.href = "{% url 'accounts:home' %}";
          }
        };
        overlay.classList.add("active");
      }

      document
        .getElementById("regSubmitBtn")
        .addEventListener("click", async function (e) {
          e.preventDefault();
          let isValid = true;

          function validateField(condition, errorId) {
            if (condition) {
              document.getElementById(errorId).style.display = "block";
              isValid = false;
            } else {
              document.getElementById(errorId).style.display = "none";
            }
          }

          validateField(
            document.getElementById("regFirstName").value.trim() === "",
            "regFirstNameError"
          );
          validateField(
            document.getElementById("regLastName").value.trim() === "",
            "regLastNameError"
          );
          const phonePattern = /^[0-9]{10,15}$/;
          const phoneValue = document.getElementById("regPhone").value.trim();
          const parentValue = document
            .getElementById("regParentPhone")
            .value.trim();

          validateField(!phonePattern.test(phoneValue), "regPhoneError");
          validateField(!phonePattern.test(parentValue), "regParentPhoneError");

          // âœ… ØªØ­Ù‚Ù‚ Ø¥Ø¶Ø§ÙÙŠ: Ù…Ù†Ø¹ ØªØ³Ø§ÙˆÙŠ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ø¹ Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
          if (phoneValue && parentValue && phoneValue === parentValue) {
            showModal({
              icon: "âš ï¸",
              title: "Ù‡Ù†Ø§Ùƒ Ø®Ø·Ø£ Ø¨Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª!",
              message: "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù‡Ùˆ Ù†ÙØ³ Ø±Ù‚Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±.",
              redirect: false,
            });
            return; // ÙˆÙ‚Ù Ø§Ù„ØªÙ†ÙÙŠØ°
          }

          validateField(
            document.getElementById("regGovernorate").value.trim() === "",
            "regGovernorateError"
          );
          validateField(
            document.getElementById("regGrade").value === "",
            "regGradeError"
          );
          validateField(
            document.getElementById("regPassword").value.length < 6,
            "regPasswordError"
          );
          validateField(
            document.getElementById("regConfirmPassword").value.trim() === "" ||
              document.getElementById("regConfirmPassword").value !==
                document.getElementById("regPassword").value,
            "regConfirmPasswordError"
          );

          // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ© (Ø¥Ù„Ø²Ø§Ù…ÙŠ)
          const avatarInput = document.getElementById("regAvatar");
          const avatarFile = avatarInput.files && avatarInput.files[0];
          if (!avatarFile) {
            validateField(true, "regAvatarError");
          } else {
            // ØªØ­Ù‚Ù‚ Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ÙˆØ§Ù„Ø­Ø¬Ù… (Ù…Ø«Ø§Ù„: Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 2 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª)
            const maxSize = 2 * 1024 * 1024; // 2MB
            const acceptTypes = ["image/jpeg", "image/png", "image/webp"];
            if (!acceptTypes.includes(avatarFile.type)) {
              document.getElementById("regAvatarError").textContent =
                "Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. Ø§Ø³ØªØ®Ø¯Ù… JPEG Ø£Ùˆ PNG Ø£Ùˆ WEBP.";
              validateField(true, "regAvatarError");
            } else if (avatarFile.size > maxSize) {
              document.getElementById("regAvatarError").textContent =
                "Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 2 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª.";
              validateField(true, "regAvatarError");
            } else {
              document.getElementById("regAvatarError").style.display = "none";
            }
          }

          if (!isValid) {
            showModal({
              icon: "âš ï¸",
              title: "Ù‡Ù†Ø§Ùƒ Ø®Ø·Ø£ Ø¨Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª!",
              message: document
                .querySelector(".reg-error[style*='block']")
                .textContent.trim(),
              redirect: false,
            });
            return;
          }

          // Ø¹Ø±Ø¶ Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ ÙÙˆØ±Ø§Ù‹
          showModal({
            icon: "â³",
            title: "Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨...",
            message: "ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹",
            redirect: false,
          });

          const form = document.getElementById("regForm");
          const formData = new FormData(form); // ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ø¢Ù† Ø¹Ù„Ù‰ Ù…Ù„Ù Ø§Ù„ØµÙˆØ±Ø©
          const csrfToken = form.querySelector(
            "input[name='csrfmiddlewaretoken']"
          ).value;

          try {
            const response = await fetch(form.action, {
              method: "POST",
              body: formData,
              headers: { "X-CSRFToken": csrfToken },
            });

            if (response.ok) {
              const data = await response.json();
              if (data.success) {
                showModal({
                  icon: "ğŸ‰",
                  title: "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!",
                  message: "âœ¨ Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¹Ø§Ø¦Ù„ØªÙ†Ø§ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ğŸ˜Š",
                  redirect: true,
                });
              } else {
                showModal({
                  icon: "âš ï¸",
                  title: "ÙØ´Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
                  message: data.message || "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹.",
                  redirect: false,
                });
              }
            } else {
              showModal({
                icon: "âš ï¸",
                title: "Ø®Ø·Ø£ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…",
                message: "Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø®Ø§Ø¯Ù…ØŒ Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§.",
                redirect: false,
              });
            }
          } catch (error) {
            showModal({
              icon: "âš ï¸",
              title: "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„",
              message: "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ù‹Ø§.",
              redirect: false,
            });
          }
        });
    </script>

    <!-- === Ø³ÙƒØ±Ø¨Øª Ø¥Ø¶Ø§ÙÙŠ Ø®ÙÙŠÙ Ù„ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© ÙØ¹Ù„ÙŠÙ‹Ø§ ÙˆØ¯ÙˆÙ† Ø­Ø°Ù Ø£ÙŠ Ø³Ø·Ø± Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø£Ø¹Ù„Ø§Ù‡ ===
         - ÙŠØ®ÙÙŠ Ø®Ø§Ù†Ø© Ø§Ù„ØµÙˆØ±Ø© Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶ (display: none) Ø¯ÙˆÙ† Ø­Ø°Ù HTML.
         - ÙŠØ¶Ø¹ Ù…Ù„Ù ÙˆÙ‡Ù…ÙŠ Ø¯Ø§Ø®Ù„ input Ù„ÙŠØ¬ØªØ§Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ.
         - ÙŠÙ…Ù†Ø¹ Ø¥Ø±Ø³Ø§Ù„ Ø£ÙŠ Ù…Ù„Ù 'avatar' Ø¹Ø¨Ø± fetch Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚Ù„ Ù…Ù† FormData.
         Ù„Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ø·ÙŠÙ„: Ø§Ø­Ø°Ù Ø£Ùˆ Ø¹Ù„Ù‘Ù‚ Ù‡Ø°Ø§ Ø§Ù„Ø³ÙƒØ±Ø¨Øª.
    -->
    <script>
      (function () {
        document.addEventListener("DOMContentLoaded", function () {
          try {
            // 1) Ø¥Ø®ÙØ§Ø¡ Ø®Ø§Ù†Ø© Ø§Ù„ØµÙˆØ±Ø© Ø¨ØµØ±ÙŠÙ‹Ø§ (HTML ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ)
            const avatarWrapper = document.getElementById("regAvatarWrapper");
            if (avatarWrapper) {
              avatarWrapper.classList.add("__hide-avatar__");
            }

            // 2) Ø¶Ø¹ Ù…Ù„Ù ÙˆÙ‡Ù…ÙŠ Ø¯Ø§Ø®Ù„ input#regAvatar Ø­ØªÙ‰ Ù„Ø§ ÙŠÙƒØ³Ø± Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ (Ø¥Ù† ÙˆÙØ¬Ø¯)
            const avatarInput = document.getElementById("regAvatar");
            if (avatarInput) {
              try {
                const blob = new Blob([""], { type: "image/png" });
                const fakeFile = new File([blob], "placeholder.png", {
                  type: "image/png",
                });
                const dt = new DataTransfer();
                dt.items.add(fakeFile);
                avatarInput.files = dt.files;
              } catch (e) {
                // ØªØ¬Ø§Ù‡Ù„ Ø¥Ø°Ø§ ÙØ´Ù„
              }
            }
          } catch (e) {
            // ØªØ¬Ø§Ù‡Ù„ Ø£ÙŠ Ø®Ø·Ø£
            console.warn("avatar-hide helper failed:", e);
          }
        });

        // 3) Ø§Ø¹ØªØ±Ø§Ø¶ fetch ÙˆØ­Ø°Ù 'avatar' Ù…Ù† FormData Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
        (function () {
          const originalFetch = window.fetch;
          window.fetch = function (input, init) {
            try {
              if (init && init.body && typeof init.body.get === "function") {
                try {
                  init.body.delete && init.body.delete("avatar");
                } catch (e) {
                  // ØªØ¬Ø§Ù‡Ù„ Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø­Ø°Ù
                }
              } else if (input instanceof Request) {
                // Ù„Ùˆ fetch Ø§Ø³ØªÙØ¯Ø¹ÙŠ Ù…Ø¹ Request ÙƒØ£ÙˆÙ„ ÙˆØ³ÙŠØ·ØŒ Ù†Ø­Ø§ÙˆÙ„ ØªØ¹Ø¯ÙŠÙ„ Ø¬Ø³Ù…Ù‡ (Ù†Ø§Ø¯Ø± Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ù†Ø§)
                try {
                  const req = input;
                  if (req && req.bodyUsed === false) {
                    // Ù„Ø§ Ù†ÙØ¹Ù„ Ø´ÙŠØ¡ Ù…Ø¹Ù‚Ø¯ Ù‡Ù†Ø§ØŒ Ù†ØªØ±Ùƒ Ø§Ù„Ø£ØµÙ„ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
                  }
                } catch (e) {}
              }
            } catch (e) {
              // ØªØ¬Ø§Ù‡Ù„
            }
            return originalFetch.apply(this, arguments);
          };
        })();
      })();
    </script>
    <!---------------------------------------------------->
  </body>
</html>




